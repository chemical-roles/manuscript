---
author-meta:
- Charles Tapley Hoyt
- Christopher J Mungall
- Nicole Vasilevsky
- "Daniel Domingo-Fern\xE1ndez"
- Matthew Healy
- Viswa Colluru
bibliography:
- content/manual-references.json
date-meta: '2020-06-30'
header-includes: "<!--\nManubot generated metadata rendered from header-includes-template.html.\nSuggest improvements at https://github.com/manubot/manubot/blob/master/manubot/process/header-includes-template.html\n-->\n<meta name=\"dc.format\" content=\"text/html\" />\n<meta name=\"dc.title\" content=\"Extension of Roles in the ChEBI Ontology\" />\n<meta name=\"citation_title\" content=\"Extension of Roles in the ChEBI Ontology\" />\n<meta property=\"og:title\" content=\"Extension of Roles in the ChEBI Ontology\" />\n<meta property=\"twitter:title\" content=\"Extension of Roles in the ChEBI Ontology\" />\n<meta name=\"dc.date\" content=\"2020-06-30\" />\n<meta name=\"citation_publication_date\" content=\"2020-06-30\" />\n<meta name=\"dc.language\" content=\"en-US\" />\n<meta name=\"citation_language\" content=\"en-US\" />\n<meta name=\"dc.relation.ispartof\" content=\"Manubot\" />\n<meta name=\"dc.publisher\" content=\"Manubot\" />\n<meta name=\"citation_journal_title\" content=\"Manubot\" />\n<meta name=\"citation_technical_report_institution\" content=\"Manubot\" />\n<meta name=\"citation_author\" content=\"Charles Tapley Hoyt\" />\n<meta name=\"citation_author_institution\" content=\"Enveda Therapeutics\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0003-4423-4370\" />\n<meta name=\"twitter:creator\" content=\"@cthoyt\" />\n<meta name=\"citation_author\" content=\"Christopher J Mungall\" />\n<meta name=\"citation_author_institution\" content=\"Division of Environmental Genomics and Systems Biology, Lawrence Berkeley National Laboratory, Berkeley, CA, USA\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-6601-2165\" />\n<meta name=\"twitter:creator\" content=\"@chrismungall\" />\n<meta name=\"citation_author\" content=\"Nicole Vasilevsky\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0001-5208-3432\" />\n<meta name=\"twitter:creator\" content=\"@N_Vasilevsky\" />\n<meta name=\"citation_author\" content=\"Daniel Domingo-Fern\xE1ndez\" />\n<meta name=\"citation_author_institution\" content=\"Enveda Therapeutics\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-2046-6145\" />\n<meta name=\"twitter:creator\" content=\"@daniel_sunday\" />\n<meta name=\"citation_author\" content=\"Matthew Healy\" />\n<meta name=\"citation_author_institution\" content=\"Enveda Therapeutics\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0001-6439-5038\" />\n<meta name=\"citation_author\" content=\"Viswa Colluru\" />\n<meta name=\"citation_author_institution\" content=\"Enveda Therapeutics\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-6208-9288\" />\n<link rel=\"canonical\" href=\"https://chemical-roles.github.io/manuscript/\" />\n<meta property=\"og:url\" content=\"https://chemical-roles.github.io/manuscript/\" />\n<meta property=\"twitter:url\" content=\"https://chemical-roles.github.io/manuscript/\" />\n<meta name=\"citation_fulltext_html_url\" content=\"https://chemical-roles.github.io/manuscript/\" />\n<meta name=\"citation_pdf_url\" content=\"https://chemical-roles.github.io/manuscript/manuscript.pdf\" />\n<link rel=\"alternate\" type=\"application/pdf\" href=\"https://chemical-roles.github.io/manuscript/manuscript.pdf\" />\n<link rel=\"alternate\" type=\"text/html\" href=\"https://chemical-roles.github.io/manuscript/v/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf/\" />\n<meta name=\"manubot_html_url_versioned\" content=\"https://chemical-roles.github.io/manuscript/v/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf/\" />\n<meta name=\"manubot_pdf_url_versioned\" content=\"https://chemical-roles.github.io/manuscript/v/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf/manuscript.pdf\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"twitter:card\" content=\"summary_large_image\" />\n<meta property=\"og:image\" content=\"https://github.com/chemical-roles/manuscript/raw/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf/thumbnail.png\" />\n<meta property=\"twitter:image\" content=\"https://github.com/chemical-roles/manuscript/raw/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf/thumbnail.png\" />\n<link rel=\"icon\" type=\"image/png\" sizes=\"192x192\" href=\"https://manubot.org/favicon-192x192.png\" />\n<link rel=\"mask-icon\" href=\"https://manubot.org/safari-pinned-tab.svg\" color=\"#ad1457\" />\n<meta name=\"theme-color\" content=\"#ad1457\" />\n<!-- end Manubot generated metadata -->"
keywords:
- ChEBI
- Cheminformatics
- Ontologies
lang: en-US
manubot-clear-requests-cache: false
manubot-output-bibliography: output/references.json
manubot-output-citekeys: output/citations.tsv
manubot-requests-cache-path: ci/cache/requests-cache
title: Extension of Roles in the ChEBI Ontology
...






<small><em>
This manuscript
([permalink](https://chemical-roles.github.io/manuscript/v/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf/))
was automatically generated
from [chemical-roles/manuscript@4ffa36e](https://github.com/chemical-roles/manuscript/tree/4ffa36e5ea08a1f68b71411d1f36b197a6085aaf)
on June 30, 2020.
</em></small>

## Authors



+ **Charles Tapley Hoyt**<br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0003-4423-4370](https://orcid.org/0000-0003-4423-4370)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [cthoyt](https://github.com/cthoyt)
    · ![Twitter icon](images/twitter.svg){.inline_icon}
    [cthoyt](https://twitter.com/cthoyt)<br>
  <small>
     Enveda Therapeutics
  </small>

+ **Christopher J Mungall**<br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-6601-2165](https://orcid.org/0000-0002-6601-2165)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [cmungall](https://github.com/cmungall)
    · ![Twitter icon](images/twitter.svg){.inline_icon}
    [chrismungall](https://twitter.com/chrismungall)<br>
  <small>
     Division of Environmental Genomics and Systems Biology, Lawrence Berkeley National Laboratory, Berkeley, CA, USA
  </small>

+ **Nicole Vasilevsky**<br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0001-5208-3432](https://orcid.org/0000-0001-5208-3432)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [nicolevasilevsky](https://github.com/nicolevasilevsky)
    · ![Twitter icon](images/twitter.svg){.inline_icon}
    [N_Vasilevsky](https://twitter.com/N_Vasilevsky)<br>
  <small>
  </small>

+ **Daniel Domingo-Fernández**<br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-2046-6145](https://orcid.org/0000-0002-2046-6145)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [ddomingof](https://github.com/ddomingof)
    · ![Twitter icon](images/twitter.svg){.inline_icon}
    [daniel_sunday](https://twitter.com/daniel_sunday)<br>
  <small>
     Enveda Therapeutics
  </small>

+ **Matthew Healy**<br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0001-6439-5038](https://orcid.org/0000-0001-6439-5038)<br>
  <small>
     Enveda Therapeutics
  </small>

+ **Viswa Colluru**<br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-6208-9288](https://orcid.org/0000-0002-6208-9288)<br>
  <small>
     Enveda Therapeutics
  </small>



## Motivation {.page_break_before}

The Chemical Entities of Biological Interest [@pmid:23180789; @pmid:26467479] ontology models chemicals, their classes, their roles, and their interrelations (Figure {@fig:overview}, left).
While many roles correspond to how their substituent chemicals affect proteins and other biological entities (see Figure {@fig:role-hierarchy}), this information is not formalized nor structured in the ChEBI ontology.
Ying *et al.* [@raw:ying2011] previously described how these correspondences could be theoretically formalized.
This article proposes a concrete schema and axioms through which these roles can be linked to their target entities (Figure {@fig:overview}, right), a suite of open source, reusable curation tools, and ultimately a manually curated database of relationships between chemical roles and their targets. 

![Schema for inference of chemicals' relations to targets via roles. Targets may be other chemicals, proteins, protein families, protein complexes, pathways, pathologies, or organisms.](images/figure_1_overview.svg){#fig:overview width="75%"}

Throughout this article, the term *role* (in the context of the ChEBI ontology) will be used in the colloquial sense described by Batchelor *et al.* [@isbn:9781607505341] rather than the formal sense prescribed by the Basic Formal Ontology [@doi:10.3233/AO-160164; @arxiv:1502.04108].

This article has been typeset with Manubot [@doi:10.1371/journal.pcbi.1007128].
Along with each named entity, we are piloting Manubot's new feature to link to entities via Identifiers.org compact URIs (CURIEs).


## Extension of the ChEBI Schema

Before generalizing the rules for the relationships between targets, it is best to examine a specific example. Chemicals that have the role p53 activator [@chebi:77731] obviously affect a certain target.
The type of effect is directly activates [@url:http://purl.obolibrary.org/obo/RO_0002406].
The type of the target is protein [@PR:000000001]. The target itself is the protein encoded by the TP53 [@hgnc:11998] gene^[Throughout this article, genes and their protein products will be referenced by their human gene symbol and HGNC identifier unless otherwise noted to improve readability.].
Because the chemical CBL0137 [@chebi:138650] has the role p53 activator [@chebi:77731], it can be inferred that CBL0137 [@chebi:138650] directly activates TP53 [@hgnc:11998].

While Ying *et al.* [@raw:ying2011] exemplified the formalization of the relationship between roles from the ChEBI ontology and their targets using the Manchester syntax^[https://www.w3.org/2007/OWL/draft/ED-owl2-manchester-syntax-20081128] to convey OWL-DL, this article will only informally describe axioms.
It is intended that these descriptions are easily understandable such that the focus can remain on the practical utility of the relations curated and inferred during the work described here.
The following informal amalgamation of a shape expression (common to graph query languages like SPARQL) and predicate logic outlines how to infer if a chemical __C__ is an activator of protein __P__ given it has the role __R__ and role __R__ is related to the activation of protein __P__.

|         | Antecedent                                                   | Consequent                     |
|---------|--------------------------------------------------------------|--------------------------------|
| ChEBI   | __C__ a Chemical<br />__R__ a Role<br />__C__ has role __R__ |                                | 
| Curated | __P__ a Protein<br />__R__ role for directly activates __P__ | __C__ directly activates __P__ |

Table: Shape expression and predicate logic rules for inferring chemicals that activate proteins linked to a given role (could be stated more concisely in OWL as *has_role o role_for_directly_activates -> directly_activates*). {#tbl:table-1}

The ChEBI ontology can be used to determine if chemical __C__ has the role __R__, but not whether __R__ is related to protein __P__, or any other protein for that matter.
This motivates the generation of a database of relations between ChEBI roles that activate proteins to support this type of inference.
After generalizing to other relationships and entity types, we generated such a database and included it with this article.

However, there are ChEBI roles that imply relations to proteins besides directly activates, so this definition needs to be generalized.
First, it should be noted that the relationship between role __R__ and protein __P__, "role for directly activates" was not taken from an ontology.
It was named based on the relation between chemical __C__ and protein __P__ that role __R__ implies.
In practice, this means that "role for" is added as a prefix.
In this example, role __R__ that corresponds to the relation "directly activates" between chemical C and protein __P__ is called "role for directly activates".
A database of relations between ChEBI roles and proteins should include the directly activates relation, but also others such as the directly inhibits [@url:http://purl.obolibrary.org/obo/RO_0002408], agonist of, antagonist of, and inverse agonist of relations^[It should be noted that the pharmacological relationships agonist, antagonist, and inverse agonist are well-defined in ChEBI, but not so much so in standardized ontologies of relationships between biochemical entities such as the Relation Ontology. See GitHub discussions at oborel/obo-relations#369 and oborel/obo-relations#371.].
The shape expression and predicate logic can be updated to reflect the relation m between role __R__ and protein __P__ that corresponds to the externally defined relation __M__ between chemical __C__ and protein __P__.

|         | Antecedent                                                            | Consequent                     |
|---------|-----------------------------------------------------------------------|--------------------------------|
| ChEBI   | __C__ a Chemical<br />__R__ a Role<br />__C__ has role __R__          |                                | 
| Curated | __P__ a Protein<br />__R__ __m__ __P__<br />__m__ correspondsTo __M__ | __C__ __M__ __P__              |

Table: Shape expression and predicate logic rules generalized for additional relationships. {#tbl:table-2}


Again, since __m__ is dependent on external relationship __M__, it is acceptable to use relationships __M__ during curation to mitigate the need for additional ontologizing.
Therefore, an entry in the database could contain the role, relationship, and protein as shown in Table {@tbl:table-3}.

| Role        | Relationship | Protein    |
|-------------|--------------|------------|
| CHEBI:77731 | RO:0002406   | HGNC:11998 |

Table: An example database entry. {#tbl:table-3}

Further, there are ChEBI roles that imply relations to entities other than proteins, so this definition must be generalized.
Rather than discussing relationships between role __R__ and protein __P__, it would suffice to discuss relationships between role __R__ and target __T__.
The relationships themselves that are appropriate should already have well-defined semantics that dictate what types of entities are valid for the range.
This article will use externally defined relationships from sources like the Relation Ontology (RO) [@https://github.com/oborel/obo-relations] when possible and avoid discussion of these semantics.
In many cases, roles __R__ can be categorized based on the types of targets __T__ that they affect (Figure {@fig:role-generalization}).


![Generalization of the ChEBI schema to include relationships between several categories of roles and their target entities.](images/figure_2_role_generalization.svg){#fig:role-generalization width="75%"}

In many cases, it is unclear what the type of entity a given ChEBI role implies.
Therefore, the database also includes explicit annotation of entity types.
This is also helpful when using databases that contain multiple entity types, such as the Gene Ontology (GO) [@doi:10.1093/nar/gky1055], and should serve to dissuade users from inferring entity types based on databases.
Now, an entry in the database should contain a role, relation, type, and target as shown in.

| Role        | Relationship | Type    | Target     |
|-------------|--------------|---------|------------|
| CHEBI:77731 | RO:0002406   | Protein | HGNC:11998 |

Table: An example database entry with entry type. {#tbl:table-4}

While not strictly necessary for the reasoning described above, it could be advantageous to enrich the existing role hierarchy with further roles that directly correspond to a given relationship and entity type (Figure {@fig:role-hierarchy}), such that maintenance of children of these terms would only necessitate the curation of the target itself.

![A hierarchy of chemical roles. Each role corresponds to a chemical having a given relationship. Within the ChEBI hierarchy, the role [@CHEBI:50906] has three children: chemical role [@CHEBI:51086], biological role [@CHEBI:24432], and application [@CHEBI:33232]. Our interest lies with the latter two.](images/figure_3_role_hieararchy.svg){#fig:role-hierarchy width="100%"}

For example, the role enzyme inhibitor [@CHEBI:23924] clearly corresponds to the entity type being protein family and the relation being directly inhibits [@url:http://purl.obolibrary.org/obo/RO_0002408].
Therefore, descendents such as EC 3.4.24.71 (endothelin-converting enzyme 1) inhibitor [@CHEBI:82974] can directly be inferred to directly inhibit a protein family.
All that would be necessary is to annotate the identity of that family, endothelin-converting enzyme 1 [@EC-CODE:3.4.24.71].
While this is already well-defined for enzyme inhibitors, it is not for other roles.
Figure {@fig:role-hierarchy} proposes a possible hierarchy of additional roles corresponding to relations and target types.
Note that proteins and protein families are considered equivalent in this context.
This article will not fully explore this concept, though during curation, several oddities were identified, such as the fact that pathway inhibitor [@CHEBI:76932] is a subclass of enzyme inhibitor [@CHEBI:23924].


## Curation Methods

Following a reasonable formalization of the schema for the extension to ChEBI, a simple set of curation guidelines were generated.

1. Identify a ChEBI role such that each has a well-defined relation and target.
2. Ground the relation to a controlled vocabulary like the RO or another carefully annotated one.
3. Identify the target's type. This is often non-trivial, especially in the cases of agonists, antagonists, and inverse agonists.
   For example, GABA antagonist [@CHEBI:65259] refers to the family of Gamma-aminobutyric acid (GABA) receptors [@hgnc.genefamily:562] while it may be mistaken to mean the chemical γ-aminobutyric acid [@CHEBI:16865].
   Alternatively, some roles really do seem to refer to the chemicals themselves such as vitamin B1 antagonist [@CHEBI:78248].
4. Ground the entity to a controlled vocabulary. Prefer those with easily accessible data such as those available through the [OBO Foundry](http://www.obofoundry.org).
   In the many cases when protein complexes and protein families cannot be grounded to a pre-existing resource, submit additional curation to the FamPlex resource [@doi:10.1186/s12859-018-2211-5] following their curation guidelines.

Below is described how roles were identified in automated or semi-automated fashion and their names were pre-processed for search.
In many cases, the Gilda grounding tool [@https://github.com/indralab/gilda] was used to prioritize candidate groundings from select databases.

### Affix-Based Role Identification

There are a number of naming conventions within ChEBI that were leveraged to quickly identify entities to be curated.
Many roles that imply common semantics share common affixes (i.e., prefixes or suffixes).
In the case of enzyme classes, the nomenclature is standardized so well that the EC number could be parsed out and relations could be generated automatically.
In a few cases, this was not possible, and either additional rules were added to the parser or in several cases issues were filed to the ChEBI tracker [@https://github.com/ebi-chebi/ChEBI/issues] to make improvements.
Table {@tbl:affixes} enumerates several of these affixes at the end of the manuscript.

### Adaptation of ChIRO

Previously, the ChEBI Integrated Role Ontology (ChIRO) [@https://github.com/obophenotype/chiro] was generated to axiomize the relationships between select ChEBI roles and other OBO ontologies; primarily the Molecular Function branch of the GO.
Many of its ~200 entries connected EC inhibitors and activators to the corresponding molecular function in GO.
Additionally, a small number of exemplar axioms were added for other branches of GO and other ontologies, for example, anti-apoptosis utilizes the GO Biological Process apoptotic process [@GO:0006915].
The ChEBI role anti-arrythmia drug [@CHEBI:38070] connects to a phenotype ontology class for Arrythmia [@HP:0011675].
However, curation of ChIRO was manual and due to limited resources the initial set of axioms were never expanded.
ChIRO did not take advantage of lexical regularities, which could have been used to automate the axiomatization of large numbers of terms, in particular EC inhibitors and activators to the corresponding enzyme class, as shown below.
Throughout the process of incorporating ChIRO into this work, several improvements were suggested through its issue tracker [@https://github.com/obophenotype/chiro/issues].

### Hierarchy-Driven Role Identification

While affix-based search had relatively high precision (with the exception of -agent, which listed many applications that were not relevant in this context), most entries do not have a naming convention.
Luckily, ChEBI is an ontology with pre-defined hierarchies defining roles including enzyme inhibitor [@CHEBI:23924], central nervous system drug [@CHEBI:35470], antidote [@CHEBI:50247], and many others.
For example, the 8 sub-roles of antidote [@CHEBI:50247] were all identified by affix, but none of the subclasses of central nervous system depressant [@CHEBI:35488] were.

ChEBI's roles hierarchy is divided into three parts: chemical role [@CHEBI:51086], biological role [@CHEBI:24432], and application [@CHEBI:33232]. Within the latter two are the most interesting roles for curation, but not all are relevant. Therefore, a blacklist was developed including irrelevant applications like protecting group [@CHEBI:51087], dye [@CHEBI:37958], and MALDI matrix material [@CHEBI:64345] as well as irrelevant or misclassified biological roles like provitamin [@CHEBI:50188], insect attractant [@CHEBI:24850], and α-D-GalN-(1→4)-\[α-DD-Hep-(1→2)\]-α-D-GalA-yl group [@CHEBI:136367]. The remaining elements from these two role hierarchies were curated.

As curation over the remaining parts of the ChEBI hierarchy resulted in the largest number of suggestions, the curation scripts were careful to remove results from previously-curated terms to reduce curator fatigue.
Additionally, a list of false positives was developed and maintained throughout curation to reduce the number of propositions and ultimately reduce curator fatigue.

### Summary Statistics

There are several ways of summarizing the 828 roles that have been curated so far.
Below, the Figure {@fig:curated-summary} summarizes the types of modulations and target entity types.

![Summaries over the types of modulations and target entity types covered by the database so far.](images/curated_summary.svg){#fig:curated-summary width="100%"}


## Inference

Before outlining a generalized strategy for inference, the liver X receptor inverse agonist [@CHEBI:90846] will be presented as an example role corresponding to the inverse agonism of the LXR family of proteins.
Its definition implies that chemicals that have this role should be inferred to affect the two members of this family LXRα [@HGNC:7966] and LXRβ [@HGNC:7965].
Therefore, the shape expression from Table {@tbl:table-2} can be extended to handle protein families over which inference should be extended to their respective members in Table {@tbl:table-5}.

|          | Antecedent                                                                   | Consequent                     |
|----------|------------------------------------------------------------------------------|--------------------------------|
| ChEBI    | __C__ a Chemical<br />__R__ a Role<br />__C__ has role __R__                 |                                | 
| Curated  | __G__ a Protein Family<br />__R__ __m__ __G__<br />__m__ correspondsTo __M__ |                                |
| External | __P__ a Protein<br />__P__ a __G__                                           | __C__ __M__ __P__              |

Table: Shape expression and predicate logic rules for reasoning over protein family memberships. {#tbl:table-5}

However, we have a number of hierarchical resources besides proteins, and sometimes these resources are several levels deep.
Additionally, chemicals and roles both have their own hierarchies by ChEBI.
In Table {@tbl:table-6}, the `a*` notation is to show variable length traversals through "is a" relationships.
This means if `A a B` and `B a C`, then A a\* C is true. This holds for chains of arbitrary length.
In the context of the `a*` operator, it is also true that `A a A`.
Finally, Table {@tbl:table-6} presents a fully generalized inference framework.

|          | Antecedent                                                                                              | Consequent                     |
|----------|---------------------------------------------------------------------------------------------------------|--------------------------------|
| ChEBI    | __C__ a Chemical<br />__R__ a Role<br />__c__ a\* __C__<br />__r__ a\* __R__<br /> __c__ has role __r__ |                                | 
| Curated  | __T__ a Target<br />__r__ __m__ __T__<br />__m__ correspondsTo __M__                                    |                                |
| External | __t__ a\* __T__                                                                                         | __c__ __M__ __T__              |

Table: A fully generalized shape expression and predicate logic rules for inference over hierarchies. {#tbl:table-6}

### Linking Roles to Gene Ontology Molecular Functions through Enzyme Classes

![Schema for inference of chemicals' relations to  molecular functions via roles and enzyme classes](images/figure_5_go_schema.svg){#fig:go-schema width="100%"}

Following the exhaustive mapping from chemical roles classifying activators or inhibitors of given enzyme classes, the EC2GO mapping [@https://geneontology.org/ontology/external2go/ec2go] provided by GO can be applied to infer on to which molecular function each chemical role exerts its effect.
Like in the first example where relation m between role __R__ and target __T__ was defined based on relation __M__ between chemical __C__ and target __T__, we define relation __M~F~__ to correspond to the relationship between a chemical and a molecular function corresponding to a given enzyme as shown in Table {@tbl:table-7}.


|          | Antecedent                                                                                                 | Consequent                                  |
|----------|------------------------------------------------------------------------------------------------------------|---------------------------------------------|
| ChEBI    | __C__ a Chemical<br />__R__ a Role<br />__C__ has role __R__                                               |                                             | 
| Curated  | __E__ an Enzyme<br />__R__ __m__ __E__<br />__m__ correspondsTo __M__<br />__m__ correspondsTo~F~ __M~F~__ |                                             |
| GO | __F__ a Molecular Function<br />__E__ hasFunction __F__                                                          | __C__ __M__ __E__<br />__C__ __M~F~__ __F__ |

Table: Shape expression and predicate logic rules inferring chemical relations to molecular functions. {#tbl:table-7}

### Implementation
 
 The acquisition of external resources and inference over hierarchies is accomplished by a simple script whose installation and execution is mediated by the Tox [@https://tox.readthedocs.io] configuration available at https://github.com/chemical-roles/chemical-roles.
 It relies heavily on the PyOBO Python package [@https://github.com/pyobo/pyobo] to acquire hierarchical data sources from OBO Foundry and generate OBO-like structures for several other resources, notably HGNC, GO, InterPro, etc.
 
### Summary Statistics

Inference over entity hierarchies resulted in over 424K new relationships.
Figure {@fig:inference-summary} summarizes them by modulation and target entity type.
Notice that each has increased by several orders of magnitude essentially for free by leveraging a vast amount of previously curated, high quality content.

![Summaries over the types of modulations and target  entity types in inferred relationships. Inference can be optionally extended over role hierarchies, which produces millions of relations.](images/inferred_summary.svg){#fig:inference-summary width="100%"}


## Interoperability

While the manually curated and inferred relations arising from this work are distributed in a simple format appropriate for wide reuse, we highlight two use cases below.

### Uptake by ChIRO and OBO

One of the goals of OBO is to facilitate modular ontology development, and provide a set of richly interlinked ontologies.
For example, many ontologies such as GO and HPO are axiomatized using ChEBI [@pubmed:23895341] for example, gliotoxin catabolism [@GO:2001309] has-input some gliotoxin [@CHEBI:5385].
ChEBI is not itself axiomatized in this way.
The ChIRO ontology was originally created as an overlay on top of ChEBI to provide this additional level of linkage.
This provides multiple advantages - users interested in concepts such as Arrythmia [@HP:0011675] in HPO can navigate to the drugs that exacerbate or inhibit it.
In particular, the use of axioms that connect from ChEBI back to GO allow for pathway queries when used in combination with GO-CAMs [@doi:10.1038/s41588-019-0500-1], for example reasoning from a gene that is upstream of a process that regulates biosynthesis of a particular chemical that itself acts as an inhibitor of another GO activity.
A workflow has been developed using Dead Simple OWL Design Patterns (DOSDP) [@pubmed:28583177]​ and the Ontology Development Kit ​(ODK) [@https://github.com/INCATools/ontology-development-kit].
DOSDPs are a generic framework that allows for generation of OWL terms and axioms using specific patterns.
The patterns are represented in a YAML file and contain slots for variables such as chemical classes from ChEBI.
The specific fillers for each variable in the pattern are represented as rows in a tab-separated values (TSV) file, which are then run through a pipeline via the ODK to generate new terms that include logical axioms that were specified by the pattern, that can be subsequently imported into the ontology.
Examples from ChIRO can be found at https://github.com/obophenotype/chiro/tree/master/src/patterns.

### Conversion to the Biological Expression Language

The Biological Expression Language (BEL) [@pubmed:24444544] is a domain specific language (DSL) for storing rich biomedical relations, supporting data integration [@doi:10.1101/631812].
The relationships curated and inferred in this work have a one-to-one correspondence with BEL statements as described in Table {@tbl:table-bel}.
The internal BEL DSL in the PyBEL software package [@pubmed:29048466] was used to implement a conversion that is included with each export.


| Relation                                | BEL Example                        |
| ----------------------------------------|------------------------------------| 
| Activation, Agonist                     | `a(X) directlyIncreases act(p(Y))` |
| Inhibition, Inverse Agonist, Antagonist | `a(X) directlyDecreases act(p(Y))` |
| Modulator                               | `a(X) regulates act(p(Y))`         |

Table: Mapping of relationships to BEL statements. {#tbl:table-bel}


## Concluding Remarks

This article identified an area of improvement in the ChEBI ontology, presented a schema for curating that data, scripts for assisting in curation, and ultimately a curated database of role-modulation-target triples.
It also presented an informal framework for inference and an implementation for doing that inference. The results of curation and inference are both available directly through the GitHub repository at https://github.com/chemical-roles/chemical-roles.

Like with most curation, this work is not complete. Curation will continue using the procedures described until exhaustion - about another 800 roles remain.
It would also be advantageous to generalize this curation technique from the roles in ChEBI to the roles in MeSH, a resource notorious for its lack of cross-references with other public biological data sources.
Several examples have already been included in the database, an ontology of chemicals from PubChem and MeSH pharmacological roles similar to ChEBI's is available through the PubChem FTP server ^[ftp://ftp.ncbi.nlm.nih.gov/pubchem/Compound/Monthly/2020-04-01/Extras/MeSH-Pharm] that enable similar inference to that presented here. 

Finally, this resource should be made as interoperable with others as possible.
It was not designed to compete with ChEBI or ChIRO, but rather to complement and enrich them.
A future goal is to automate the upload of the results to WikiData through a bot to bolster their chemical data integration efforts.
Most importantly is to enable the ChEBI curators and the greater OBO community to best intake these relations into their ontologies and inference frameworks to benefit their work.


## Resource Availability

All code used in the curation workflow is available at https://github.com/chemical-roles/chemical-roles under the MIT License.
All manually curated data comprising the database are also available at https://github.com/chemical-roles/chemical-roles under the CC0 License.
All code and data are archived on Zenodo at https://doi.org/10.5281/zenodo.3883800.

## Acknowledgements

This work would not have been possible without the work done by the excellent team of curators and maintainers of ChEBI, especially Janna Hastings and Adnan Malik.

## Author Contributions

CTH designed the study. CTH, NV, MH, and DDF curated content.
CTH, CM, NV and VC wrote the manuscript.
All authors contributed to editing and revision.
All authors have approved the final manuscript.

## Conflict of Interest

The authors declare that they have no conflict of interest.

## References {.page_break_before}

<!-- Explicitly insert bibliography here -->
<div id="refs"></div>


## Appendix

|   | Affix                                 | Description |
|---|---------------------------------------|-------------|
| P | anti-                                 | Various agents against biological processes (e.g., anti-inflammatory drug [@CHEBI:35472]), pathologies (e.g., antihyperplasia drug [@CHEBI:5984]), and organisms (e.g., anti-HIV-1 agent [@CHEBI:64947]).
| P | antidote to-                          | Antidotes for poisons (e.g., antidote to opioid poisoning [@CHEBI:90755]).
| A | EC-...-inhibitor or EC-...- activator | Inhibitors of enzymes. The ChEBI hierarchy of roles implicitly models the enzyme classification with the root term being enzyme inhibitor [@CHEBI:23924]. However, some terms have the suffix of -activator, which do not have corresponding roles nor a corresponding root term enzyme activator.
| S | -activator                            | Activators of proteins (e.g., p53 activator [@CHEBI:77731]), protein complexes (e.g., soluble guanylate cyclase activator [@CHEBI:76022]), protein families (e.g., UDP-glucuronosyltransferase activator [@CHEBI:77324]), enzyme classes (e.g., EC 2.7.11.31 {[hydroxymethylglutaryl-CoA reductase (NADPH)] kinase} activator [@CHEBI:85053]), pathways (e.g., hypoxia-inducible factor pathway activator [@CHEBI:134083])
| S | -inducer                              | Inducers of protein families (e.g., Hsp70 inducer [@CHEBI:78606]), pathways (e.g. apoptosis inducer [@CHEBI:68495]). The difference in semantics between activator and inducer is unclear, and it seems that activator was preferred by ChEBI curators. Only three entries, interferon inducer [@CHEBI:36710] being the third, have this suffix.
| S | -inhibitor                            | Inhibitors of proteins (e.g., MTP inhibitor [@CHEBI:72298]), protein complexes (e.g., eukaryotic initiation factor 4F inhibitor [@CHEBI:137079]), protein families (e.g. glycine transporter inhibitor [@CHEBI:85425]), enzyme classes (e.g., EC 1.1.1.188 (prostaglandin-F synthase) inhibitor [@CHEBI:77425]), pathways (e.g., autophagy inhibitor [@CHEBI:88230])
| S | -agonist                              | Agonists of proteins (e.g., aryl hydrocarbon receptor agonist [@CHEBI:72768]), protein families (e.g., cannabinoid receptor agonist [@CHEBI:67072])
| S | -antagonist                           | Antagonists of proteins (e.g., aryl hydrocarbon receptor antagonist [@CHEBI:76998]), protein families (e.g., cannabinoid receptor antagonist [@CHEBI:73413])
| S | -inverse agonist                      | Inverse agonists of proteins (e.g., 5-hydroxytryptamine 2A receptor inverse agonist [@CHEBI:133016]), protein families (e.g., liver X receptor inverse agonist [@CHEBI:90846]). Unfortunately, these are the only two such entries. They both inherit from inverse agonist [@CHEBI:90847].
| S | -modulator                            | Modulators (lacking the polarity described by activators or inhibitors) of proteins (e.g., retinoic acid receptor modulator [@CHEBI:90708]), protein complexes (e.g., γ-secretase modulator [@CHEBI:48668]), protein families (e.g., PPAR modulator [@CHEBI:70781]), cellular components (e.g., tubulin modulator [@CHEBI:60832])
| S | -suppressor / -suppressant            | Like -inducer, there are only a handful of examples. The preferred suffix is -inhibitor
| S | -deactivator                          | Surprisingly, there were no terms in ChEBI using this suffix
| S | -drug                                 | Drugs treating pathways (e.g., anti-inflammatory drug [@CHEBI:35472]), pathologies (e.g., antiglaucoma drug [@CHEBI:39456]), infections (e.g., trypanocidal drug [@CHEBI:36335]), and psychoses (e.g., tranquilizing drug [@CHEBI:35473]). However, most drugs treating psychoses are children of central nervous system drug [@CHEBI:35470] and do not end in the suffix -drug.
| S | -agent                                | Agents cover a wide variety of biology from drugs (e.g., antihypotensive agent [@CHEBI:137431]) to toxins/poisons (e.g., VR nerve agent [@CHEBI:140422]) and other applications.
| S | -stabilizer / -stabiliser             | This search was included because of the notes from ChIRO, but no terms in ChEBI corresponded to it.
| S | -destabilizer / -destabiliser         | This search was included because of the notes from ChIRO, but no terms in ChEBI corresponded to it.
| S | -sensitizer / -sensitiser             | This search was included because of the notes from ChIRO, but no terms in ChEBI had this suffix besides the role sensitiser [@CHEBI:139492]

Table: Affixes used for initial targeted curation. In the first column, P corresponds to prefix, S to suffix, and A to both in the case of "EC-...-inhibitor/activator". {#tbl:affixes}
